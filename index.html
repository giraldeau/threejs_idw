<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="container"></div>

<script id="vertexShader" type="x-shader/x-vertex">
        void main() {
            gl_Position = vec4( position, 1.0 );
        }


</script>
<script id="fragmentShader" type="x-shader/x-fragment">
        uniform vec2 u_resolution;
        uniform float u_time;
        uniform vec3 u_points [ 3 ];

        float circle(in vec2 _st, in float _radius){
            vec2 dist = _st-vec2(0.5);
            return 1.-smoothstep(_radius-(_radius*0.01),
                _radius+(_radius*0.01),
                dot(dist,dist)*4.0);
        }

        float idw(in vec2 _st) {
             vec2 loc = vec2(0.3,0.3);
             vec2 loc2 = vec2(0.7, 0.7);
             vec3 pts;

             float prop = 0.0;
             float dist = 0.0;

             float weigthed_prop = 0.0;

             float weigthed_prop_sum = 0.0;
             float weigth_sum = 0.0;

             for (int i = 0; i < 3; i++) {
                 pts = u_points[i];
                 loc = pts.xy;
                 prop = pts[2];

                 //prop = float(i) * 0.8 + 0.2;
                 dist = distance(_st, loc);
                 weigthed_prop_sum = weigthed_prop_sum + (prop / dist);
                 weigth_sum = weigth_sum + (1.0 / dist);
             }

             return (weigthed_prop_sum / weigth_sum);
        }

        vec3 prop2color(in float _prop) {
            float propMin = 0.0;
            float propMax = 100.0;
            float colorLevel = smoothstep(propMin, propMax, _prop);

             return vec3(0.0, 0.0, colorLevel);
        }

        void main() {
            vec2 st = gl_FragCoord.xy/u_resolution.xy;
            /*
            float pct = 0.0;
            pct = distance(st, vec2(0.5));
            vec3 color = vec3(pct);
            */

            float prop = idw(st);

            vec3 color = prop2color(prop);

            // vec3 color = vec3(circle(st,0.6));

            gl_FragColor=vec4(prop2color(idw(st)),1.0);

        }


</script>
<script src="bundle.js"></script>
<script>
  var container;
  var camera, scene, renderer;
  var uniforms;

  init();
  animate();

  function init () {
    container = document.getElementById('container');

    camera = new THREE.Camera();
    camera.position.z = 1;

    scene = new THREE.Scene();

    var geometry = new THREE.PlaneBufferGeometry(2, 2);

    uniforms = {
      u_time: {type: 'f', value: 1.0},
      u_resolution: {type: 'v2', value: new THREE.Vector2()},
      u_mouse: {type: 'v2', value: new THREE.Vector2()},
      u_points: {
        type: 'v3v', value: [
          new THREE.Vector3(0.2, 0.2, 1.0),
          new THREE.Vector3(0.8, 0.8, 100.0),
          new THREE.Vector3(0.1, 0.9, 50.0)
        ]
      }
    }

    var material = new THREE.ShaderMaterial({
      uniforms: uniforms,
      vertexShader: document.getElementById('vertexShader').textContent,
      fragmentShader: document.getElementById('fragmentShader').textContent
    });

    var mesh = new THREE.Mesh(geometry, material);
    scene.add(mesh);

    renderer = new THREE.WebGLRenderer();
    renderer.setPixelRatio(window.devicePixelRatio);

    container.appendChild(renderer.domElement);

    onWindowResize();
    window.addEventListener('resize', onWindowResize, false);

    document.onmousemove = function (e) {
      uniforms.u_mouse.value.x = e.pageX;
      uniforms.u_mouse.value.y = e.pageY;
    }
  }

  function onWindowResize (event) {
    renderer.setSize(window.innerWidth, window.innerHeight);
    uniforms.u_resolution.value.x = renderer.domElement.width;
    uniforms.u_resolution.value.y = renderer.domElement.height;
  }

  function animate () {
    requestAnimationFrame(animate);
    render();
  }

  function render () {
    uniforms.u_time.value += 0.05;
    renderer.render(scene, camera);
  }
</script>
</body>
</html>